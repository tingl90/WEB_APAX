
@{
    ViewBag.Title = "ThuHocPhi";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<input type="hidden" value="@ViewBag.NguoiThuHocPhi" id="NguoiThuHocPhi" />
<div class="box box-danger">
    <div class="box-header with-border">
        <h3 class="box-title">Thu học phí</h3>
    </div>
    <!-- /.box-header -->
    <!-- form start -->
    <form class="form-horizontal">
        <!--Menu-->
        <div class="margin text-right">
            <div class="btn-group"><button type="button" class="btn btn-block btn-danger" onclick="ThemMoi()">Thêm mới</button></div>
            <div class="btn-group"><button type="button" class="btn btn-block btn-danger" id="btn_Luu" onclick="ThuTien()">Thu tiền</button></div>
            <div class="btn-group"><button type="button" class="btn btn-block btn-danger" onclick="Xoa()">Xóa</button></div>
            <div class="btn-group"><button type="button" class="btn btn-block btn-danger">Print</button></div>
        </div>
        <!--/Menu-->
        <div class="box-body" style="margin-top: -30px">
            <div class="col-md-6">
                <div class="form-group">
                    <h5><label class="col-sm-12 control-label text-bold" style="text-align:left">THÔNG TIN HỌC VIÊN</label></h5>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" style="padding-left:0px">Tên học viên</label>
                    <div class="col-sm-10">
                        <div class="input-group">
                            <input type="text" class="form-control" id="TIMKIEMHOCVIEN" readonly>
                            <span class="input-group-btn">
                                <button type="button" class="btn btn-block btn-danger" onclick="TimKiemHocSinh()">Tìm kiếm</button>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">Mã HV</label>
                    <div class="col-sm-4">
                        <input type="text" id="MaHocVien" readonly class="form-control">
                    </div>
                    <label class="col-sm-2 control-label">Mã LMS</label>
                    <div class="col-sm-4">
                        <input type="text" id="MaLMS" readonly class="form-control">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">EC</label>
                    <div class="col-sm-4">
                        <input type="text" id="EC" readonly class="form-control">
                    </div>
                    <label class="col-sm-2 control-label">CM</label>
                    <div class="col-sm-4">
                        <input type="text" id="CM" readonly class="form-control">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">EC Leader</label>
                    <div class="col-sm-4">
                        <input type="text" id="ECLEADER" readonly class="form-control">
                    </div>
                    <label class="col-sm-2 control-label">CM Leader</label>
                    <div class="col-sm-4">
                        <input type="text" id="CMLEADER" readonly class="form-control">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">Giám đốc TT</label>
                    <div class="col-sm-4">
                        <input type="text" id="GDTT" readonly class="form-control">
                    </div>
                    <label class="col-sm-2 control-label">Giám đốc vùng</label>
                    <div class="col-sm-4">
                        <input type="text" id="GDV" readonly class="form-control">
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <h5><label class="col-sm-12 control-label text-bold" style="text-align:left">THỰC HIỆN THU TIỀN</label></h5>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label" style="padding-left:0px">Tổng tiền đăng ký</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" readonly id="TongTienDangKy" placeholder="">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">Tổng tiền đã thu</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" readonly id="TongTienDaThu" placeholder="">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">Tổng tiền thu</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" id="TongTienThu" placeholder="">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">Công nợ còn lại</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" readonly id="TongCongNo" placeholder="">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">Hình thức thu</label>
                    <div class="col-sm-9">
                        <div id="HinhThucThu" style="width:100%"></div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /.box-body -->
        <div class="box-body" style="margin-top:-15px">
            <div class="col-md-6">
                <div class="form-group">
                    <h5><label class="col-sm-12 control-label text-bold" style="text-align:left">THÔNG TIN ĐĂNG KÝ CHƯƠNG TRÌNH HỌC</label></h5>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" style="padding:7px 0px">Chương trình</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" readonly id="ChuongTrinhHoc" placeholder="">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">Trung tâm</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" readonly id="TrungTam" placeholder="">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">Số buổi</label>
                    <div class="col-sm-4">
                        <input type="text" id="SoBuoi" readonly class="form-control">
                    </div>
                    <label class="col-sm-2 control-label">Đơn giá</label>
                    <div class="col-sm-4">
                        <input type="text" id="DonGia" readonly class="form-control">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">Chiết khấu</label>
                    <div class="col-sm-4">
                        <input type="text" id="ChietKhau" readonly class="form-control">
                    </div>
                    <label class="col-sm-2 control-label" style="padding-left: 0px!important">Thành tiền</label>
                    <div class="col-sm-4">
                        <input type="text" id="ThanhTien" readonly class="form-control">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" style="padding-left:0px">Ngày đăng ký</label>
                    <div class="col-sm-4">
                        <input type="text" id="NgayDangKy" readonly class="form-control">
                    </div>
                    <label class="col-sm-2 control-label" style="padding:7px 0px">Ngày dự kiến học</label>
                    <div class="col-sm-4">
                        <input type="text" id="NgayDuKienHoc" readonly class="form-control">
                    </div>
                </div>
                <div class="form-group" style="margin-bottom: 0px;">
                    <div class="col-md-6">

                    </div>
                    <div class="col-md-6">
                        <div class="form-group">

                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <label class="col-sm-3 control-label">Loại thu tiền</label>
                    <div class="col-sm-9">
                        <div id="LoaiThuTien" style="width:100%"></div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">Ghi chú</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" id="GhiChu">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label" style="padding-left:0px">Ngày thu tiền</label>
                    <div class="col-sm-3">
                        <div id="NgayThuTien" style="width:100%"></div>
                    </div>
                    <label class="col-sm-3 control-label" style="padding:7px 0px">Người thu tiền</label>
                    <div class="col-sm-3">
                        <input type="text" id="NguoiThuTien" data-foo readonly class="form-control">
                        @*<div id="NguoiThuTien" style="width:100%"></div>*@
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
<div class="modal fade" id="TimHocVien" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-red">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
                <h4 class="modal-title">Danh sách học sinh</h4>
            </div>
            <div class="modal-body">
                <div id="gridDanhSachHocSinh">
                </div>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<div class="box box-danger">
    <div class="box-header with-border">
        <h3 class="box-title">Lịch sử thu học phí</h3>
    </div>
    <!-- /.box-header -->
    <!-- form start -->
    <form class="form-horizontal">
        <div class="row">
            <div class="col-md-12">
                <div id="gridLichSuDangKy"></div>
            </div>
        </div>
        <!-- /.box-body -->
    </form>
</div>
<script>
    var a_hosokhachhang = 0, tongcongno = 0, a_thhopdong;
    var now = new Date();
    $(document).ready(function () {
        $('#btn_Luu').prop('disabled', false);
        $("#NgayThuTien").dxDateBox({
            value: now,
            formatString: 'dd/MM/yyyy',
            onValueChanged: function (data) {

            },
        }).dxDateBox("instance");
        //NguoiThuTien();
        HinhThucThu();
        LoaiThuTien();
        LoadLichSuThuPhi(0, 0);
        $('#TongTienThu').keyup(function () {
            $(this).val(format_Money($('#TongTienThu').val().replace(new RegExp(',', 'g'), '')));
        });
        $('#NguoiThuTien').val($('#NguoiThuHocPhi').val());
    })
    @*function NguoiThuTien() {
        $.ajax({
            url: '@Url.Action("DM_NguoiThuPhi", "ThuPhi")',
            type: 'GET',
            contentType: 'application/json',
            success: function (rs) {
                $("#NguoiThuTien").dxSelectBox({
                    items: rs,
                    showPopupTitle: false,
                    displayExpr: "TENDTTC",
                    valueExpr: "ID_DTTC",
                    value: nguoitt,
                    searchEnabled: true,
                    onValueChanged: function (e) {
                    },
                });
            }
        })
    }*@
    function HinhThucThu() {
        $.ajax({
            url: '@Url.Action("Get_CB_HinhThucThu", "ThuPhi")',
            type: 'GET',
            contentType: 'application/json',
            success: function (rs) {
                $("#HinhThucThu").dxSelectBox({
                    items: rs,
                    showPopupTitle: false,
                    displayExpr: "TENLOAIPHIEUTHU",
                    valueExpr: "ID_LOAIPHIEUTHU",
                    searchEnabled: true,
                    onValueChanged: function (e) {
                    },
                });
            }
        })
    }
    function LoaiThuTien() {
        $.ajax({
            url: '@Url.Action("Get_CB_LoaiThuTien", "ThuPhi")',
            type: 'GET',
            contentType: 'application/json',
            success: function (rs) {
                $("#LoaiThuTien").dxSelectBox({
                    items: rs,
                    showPopupTitle: false,
                    displayExpr: "TENLOAITHUTIEN",
                    valueExpr: "ID_LOAITHUTIEN",
                    searchEnabled: true,
                    onValueChanged: function (e) {
                    },
                });
            }
        })
    }
    function TimKiemHocSinh() {
        $('#TimHocVien').modal('show');
        LoadDanhSachHocVien();
    }
    function format_Money(nStr) {
        nStr += '';
        x = nStr.split('.');
        x1 = x[0];
        x2 = x.length > 1 ? ',' + x[1] : '';
        var rgx = /(\d+)(\d{3})/;
        while (rgx.test(x1)) {
            x1 = x1.replace(rgx, '$1' + ',' + '$2');
        }
        return x1 + x2;
    }
    function LoadDanhSachHocSinh(hocvien)
    {
        $('#TimHocVien').modal('hide');
        $.ajax({
            url: '@Url.Action("GetDanhSachHocSinhChuaXepLop", "ThuPhi")',
            type: 'GET',
            data: { HocVien: hocvien },
            contentType: 'application/json',
            success: function (rs) {
                if (rs.length > 0) {
                    $('#MaHocVien').val(rs[0].MaHocVien);
                    $('#MaLMS').val(rs[0].MALMS);
                    $('#EC').val(rs[0].EC);
                    $('#CM').val(rs[0].CM);
                    $('#ECLEADER').val(rs[0].ECLEADER);
                    $('#CMLEADER').val(rs[0].CMLEADER);
                    $('#GDTT').val(rs[0].GDTT);
                    $('#GDV').val(rs[0].GDV);
                    $('#TIMKIEMHOCVIEN').val(rs[0].TenHocVien);
                    $('#ChuongTrinhHoc').val(rs[0].ChuongTrinh);
                    $('#TrungTam').val(rs[0].TrungTam);
                    $('#SoBuoi').val(rs[0].SoBuoi);
                    $('#DonGia').val(format_Money(rs[0].DonGia));
                    $('#ChietKhau').val(rs[0].CHIETKHAU);
                    $('#ThanhTien').val(format_Money(rs[0].TongTien));
                    $('#NgayDangKy').val(rs[0].NgayDangKy);
                    $('#NgayDuKienHoc').val(rs[0].NgayBatDau);
                    //$('#NguoiThuTien').val($('#NguoiThuHocPhi').val());
                    $('#TongTienDangKy').val(format_Money(rs[0].TongTien));
                    $('#TongTienDaThu').val(format_Money(rs[0].TienDaThu));
                    $('#TongTienThu').focusout(function () {
                        tongcongno = Number(rs[0].TongTien) - Number(rs[0].TienDaThu) - $('#TongTienThu').val().replace(new RegExp(',', 'g'), '');
                        if (tongcongno >= 0) {
                            $('#TongCongNo').val(format_Money(tongcongno));
                        } else {
                            DevExpress.ui.notify('Tổng tiền thu không được vượt quá tiền đăng ký! Vui lòng kiểm tra lại.', 'warning', 2000);
                            $('#TongCongNo').val(0);
                            $('#TongTienThu').val(0);
                        }
                    })
                    a_hosokhachhang = rs[0].A_HOSOKHACHHANG;
                    a_thhopdong = rs[0].A_TH_HOPDONG;
                    LoadLichSuThuPhi(a_hosokhachhang, a_thhopdong);
                }
            }
        })

    }
    function ThemMoi()
    {
        $('#btn_Luu').prop('disabled', false);
        LoadLichSuThuPhi(0,0);
        $('#TIMKIEMHOCVIEN').val('');
        $('#MaHocVien').val('');
        $('#MaLMS').val('');
        $('#EC').val('');
        $('#CM').val('');
        $('#ECLEADER').val('');
        $('#CMLEADER').val('');
        $('#GDTT').val('');
        $('#GDV').val('');
        $('#TenHocVien').val('');
        $('#ChuongTrinhHoc').val('');
        $('#TrungTam').val('');
        $('#SoBuoi').val('');
        $('#DonGia').val('');
        $('#ChietKhau').val('');
        $('#ThanhTien').val('');
        $('#NgayDangKy').val('');
        $('#NgayDuKienHoc').val('');
        $('#TongTienDangKy').val('');
        $('#TongTienDaThu').val('');
        $('#TongTienThu').val('');
        $('#TongCongNo').val('');
        $("#HinhThucThu").dxSelectBox('instance').option('value', null);
        $("#LoaiThuTien").dxSelectBox('instance').option('value', null);
        $('#GhiChu').val('');
        $("#NgayThuTien").dxDateBox('instance').option('value', null);
        $('#NguoiThuTien').val($('#NguoiThuHocPhi').val());
        $("#NgayThuTien").dxDateBox({
            value: now,
            formatString: 'dd/MM/yyyy',
            onValueChanged: function (data) {
            },
        }).dxDateBox("instance");
    }
    function Xoa()
    {
        var array = [];
        var dataGrid = $('#gridLichSuDangKy').dxDataGrid('instance');
        var keys = dataGrid.getSelectedRowKeys();
        $.each(keys, function (i, v) {
            array.push(v.A_TH_THUTIEN);
        })
        if (keys.length > 0) {
            $.ajax({
                url: '@Url.Action("XoaThuTien", "ThuPhi")',
                data: { A_TH_THUTIEN: array.join(',') },
                success: function (data) {
                    if (data == 1) {
                        DevExpress.ui.notify('Xóa thành công', 'success', 2000);
                        LoadLichSuThuPhi(a_hosokhachhang, a_thhopdong);
                        $('#MaHocVien').val('');
                        $('#MaLMS').val('');
                        $('#EC').val('');
                        $('#CM').val('');
                        $('#ECLEADER').val('');
                        $('#CMLEADER').val('');
                        $('#GDTT').val('');
                        $('#GDV').val('');
                        $('#TenHocVien').val('');
                        $('#ChuongTrinhHoc').val('');
                        $('#TrungTam').val('');
                        $('#SoBuoi').val('');
                        $('#DonGia').val('');
                        $('#ChietKhau').val('');
                        $('#ThanhTien').val('');
                        $('#NgayDangKy').val('');
                        $('#NgayDuKienHoc').val('');
                        $('#NguoiThuTien').val('');
                        $('#TongTienDangKy').val('');
                        $('#TongTienDaThu').val('');
                        $('#TongTienThu').val('');
                        $('#TongCongNo').val('');
                        $("#HinhThucThu").dxSelectBox('instance').option('value', null);
                        $("#LoaiThuTien").dxSelectBox('instance').option('value', null);
                        $('#GhiChu').val('');
                        $("#NgayThuTien").dxDateBox('instance').option('value', null);
                        //$("#NguoiThuTien").dxSelectBox('instance').option('value', null);
                    }
                    else {
                        DevExpress.ui.notify('Xóa thất bại', 'error', 2000);
                    }
                }
            })
        }
        else DevExpress.ui.notify('Bạn chưa chọn dòng để xóa', 'warning', 2000);
    }
    function ThuTien() {
        var result = DevExpress.ui.dialog.confirm('Bạn có muốn lưu kết quả không?', "Xác nhận thay đổi");
        result.done(function (dialogResult) {
            if (dialogResult) {
                $('#btn_Luu').prop('disabled', true);
                $.ajax({
                    url: '@Url.Action("SaveThuHocPhi", "ThuPhi")',
                    data: {
                        J_HOSOKHACHHANG: a_hosokhachhang, J_TH_HOPDONG: a_thhopdong, NgayThuTien: Globalize.format($("#NgayThuTien").dxDateBox('instance').option('value'), 'yyyy-MM-dd'),
                        SoTienThu: $('#TongTienThu').val(), NguoiThuTien: $('#NguoiThuTien').val(),
                        HinhThucThu: $('#HinhThucThu').dxSelectBox('instance').option('value'),
                        LoaiThuTien: $('#LoaiThuTien').dxSelectBox('instance').option('value'), GhiChu: $('#GhiChu').val(),
                        EC: $('#EC').val(), CM: $('#CM').val(), ECLEADER: $('#ECLEADER').val(),
                        CMLEADER: $('#CMLEADER').val(), GDTT: $('#GDTT').val(), GDV: $('#GDV').val()
                    },
                    success: function (data) {
                        if (data > 0) {
                            DevExpress.ui.notify('Cập nhật thành công', 'success', 2000);
                            LoadLichSuThuPhi(a_hosokhachhang, a_thhopdong);
                        }
                        else {
                            DevExpress.ui.notify('Chỉ thu ngân mới được thu tiền', 'error', 2000);
                        }
                    }
                })
            }
            else {
            }
        });
    }
    function LoadDanhSachHocVien() {
        $.ajax({
            url: '@Url.Action("LoadDanhSachHocSinhChuaXepLop", "ThuPhi")',
            type: 'GET',
            data: { MaHocVien: null },
            contentType: 'application/json',
            success: function (rs) {
                var dataGrid = $("#gridDanhSachHocSinh").dxDataGrid({
                    dataSource: rs,
                    allowColumnReordering: false,
                    allowColumnResizing: false,
                    columnAutoWidth: false,
                    columnFixing: {
                        enabled: true
                    },
                    paging: {
                        pageSize: 10
                    },
                    pager: {
                        showPageSizeSelector: true,
                        allowedPageSizes: [10, 20, 50],
                        showInfo: true
                    },
                    showColumnLines: true,
                    showRowLines: true,
                    filterRow: {
                        visible: true,
                        applyFilter: "auto"
                    },
                    columns: [
                        {
                            caption: "Chọn", alignment: 'center',
                            width: 100,
                            cellTemplate: function (container, options) {
                                var dt = options.data;
                                $('<a href="javascript:" onclick="LoadDanhSachHocSinh(' + dt.A_TH_HOPDONG + ')"  class="text-green"><b>...</b></a>').appendTo(container);
                            }
                        },
                          {
                              dataField: "MaHocVien",
                              caption: "Mã học sinh",
                              width: 120,
                          }, {
                              dataField: "TenHocVien",
                              caption: "Tên học sinh",
                              width: 200,
                          },
                           {
                               dataField: "DiDong",
                               caption: "Di động",
                               width: 200,
                           },
                          {
                              dataField: "Email",
                              caption: "Email",
                              width: 120,
                          }, {
                              dataField: "DiaChi",
                              caption: "Địa chỉ",
                              width: 200,
                          },
                          {
                              dataField: "SoBuoi",
                              caption: "Số buổi",
                              width: 120,
                          },
                          {
                              caption: "Tổng tiền",
                              dataField: "TongTien",
                              width: 120,
                          },
                          {
                              caption: "Tiền đã thu",
                              dataField: "TienDaThu",
                              width: 120,
                          },
                    ],

                }).dxDataGrid('instance');
            },
            error: function (a, b, c) {
                DevExpress.ui.notify('Error ' + a.status + ': ' + a.statusText, 'error', 2000);
            }

        });
    }

    function LoadLichSuThuPhi(hv,hd) {
        $.ajax({
            url: '@Url.Action("LichSuThuPhi", "ThuPhi")',
            type: 'GET',
            data: { KhachHang: hv, HopDong:hd,loai : 1 },
            contentType: 'application/json',
            success: function (rs) {
                var dataGrid = $("#gridLichSuDangKy").dxDataGrid({
                    dataSource: rs,
                    allowColumnReordering: false,
                    allowColumnResizing: false,
                    columnAutoWidth: false,
                    columnFixing: {
                        enabled: true
                    },
                    paging: {
                        pageSize: 10
                    },
                    pager: {
                        showPageSizeSelector: true,
                        allowedPageSizes: [10, 20, 50],
                        showInfo: true
                    },
                    selection: {
                        mode: 'multiple'
                    },
                    showColumnLines: true,
                    showRowLines: true,
                    filterRow: {
                        visible: true,
                        applyFilter: "auto"
                    },
                    columns: [
                          {
                              dataField: "NGAYTHUTIEN",
                              caption: "Ngày thu tiền",
                              width: 200,
                              alignment: "right",
                          }, {
                              dataField: "NguoiThuTien",
                              caption: "Người thu tiền",
                              width: 250,
                          },
                           {
                               dataField: "TONGTIEN_HD",
                               caption: "Tổng tiền đăng ký",
                               width: 200,
                               format: "fixedPoint",
                               alignment: "right",
                           },
                          {
                              dataField: "SOTIENTHU",
                              caption: "Số tiền thu",
                              width: 200,
                              format: "fixedPoint",
                              alignment: "right",
                          }, {
                              dataField: "TENLOAIPHIEUTHU",
                              caption: "Hình thức thu",
                              width: 200,
                          },
                          {
                              dataField: "TENLOAITHUTIEN",
                              caption: "Loại thu tiền",
                              width: 200,
                          },
                    ],
                    onSelectionChanged: function (selectedItems) {
                        var data = selectedItems.selectedRowsData[0];
                        if (data) {
                            $('#btn_Luu').prop('disabled', true);
                            $.ajax({
                                url: '@Url.Action("ChiTietLichSu", "ThuPhi")',
                                data: { KhachHang: hv, HopDong: hd, loai: 1, LichSu: data.A_TH_THUTIEN },
                                success: function (rs) {
                                    $('#TongTienDangKy').val(format_Money(rs[0].TONGTIEN_HD));
                                    $('#TongTienDaThu').val(format_Money(rs[0].TienDaThu));
                                    $('#TongTienThu').val(format_Money(rs[0].SOTIENTHU));
                                    var congno = rs[0].TONGTIEN_HD - rs[0].TienDaThu;
                                    $('#TongCongNo').val(format_Money(congno));
                                    $("#HinhThucThu").dxSelectBox('instance').option('value', rs[0].ID_LOAIPHIEUTHU);
                                    $("#LoaiThuTien").dxSelectBox('instance').option('value', rs[0].ID_LOAITHUTIEN);
                                    $('#GhiChu').val(rs[0].GHICHUTHUTIEN);
                                    $("#NgayThuTien").dxDateBox('instance').option('value', rs[0].NGAYTHUTIEN2);
                                    $('#NguoiThuTien').val(rs[0].TAIKHOAN);
                                }
                            })
                        }
                    }
                }).dxDataGrid('instance');
            },
            error: function (a, b, c) {
                DevExpress.ui.notify('Error ' + a.status + ': ' + a.statusText, 'error', 2000);
            }

        });
    }
</script>
